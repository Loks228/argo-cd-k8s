# k8s-manifests/argocd-apps/loki-ingress-app.yaml

apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: loki-ingress
  namespace: argocd
spec:
  # 🚨 ИСПОЛЬЗУЕМ ВАШ ПРОЕКТ ПЛАТФОРМЫ
  project: minemap-monitoring 
  source:
    # ⚠️ УКАЖИТЕ ВАШ РЕПОЗИТОРИЙ
    repoURL: https://github.com/Loks228/argo-cd-k8s.git 
    targetRevision: HEAD 
    # 🚨 ПУТЬ К ПАПКЕ, ГДЕ ЛЕЖИТ ingress.yaml
    path: k8s-manifests/ingress/loki/

  destination:
    server: https://kubernetes.default.svc
    # 🚨 ДЕПЛОЙ ТОЛЬКО В LOKI NAMESPACE
    namespace: loki 
    
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
    - CreateNamespace=true