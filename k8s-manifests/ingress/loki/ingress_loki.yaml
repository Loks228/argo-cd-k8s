apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: loki-ingress
  namespace: loki
  annotations:
    # 1. –®–ª—è—Ö –¥–ª—è Health Check (–≤–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–æ–¥–∞–ª–∏)
    appgw.ingress.kubernetes.io/probe-path: "/metrics"
    
    # üõë 2. –ö–†–ò–¢–ò–ß–ù–û –í–ê–ñ–õ–ò–í–û: –ö–∞–∂–µ AAG –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ HTTP –¥–ª—è –±—ç–∫–µ–Ω–¥–∞ Loki
    appgw.ingress.kubernetes.io/backend-protocol: "Http" 
    
    # 3. –†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è: –î–æ–≤—à–∏–π —Ç–∞–π–º–∞—É—Ç, —â–æ–± –Ω–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ 502 –ø—Ä–∏ –∑–∞—Ç—Ä–∏–º–∫–∞—Ö
    appgw.ingress.kubernetes.io/request-timeout: "120"
    kubernetes.io/ingress.class: "nginx"
    cert-manager.io/cluster-issuer: letsencrypt-prod
spec:
  tls:
    - hosts:
        - loki-minemap.pp.ua
      secretName: loki-tls

  rules:
    - host: loki-minemap.pp.ua
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: loki
                port:
                  number: 3100
